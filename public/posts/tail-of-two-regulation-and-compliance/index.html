<!doctype html><html lang=en dir=auto><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>NOTES: Tail of Two Regulation and Compliance | T|A</title><meta name=keywords content="notes,fintech,compliance,HIPAA,SOC2,devops,lessons"><meta name=description content="Notes from building fintech features and surviving real audits."><meta name=author content="Me"><link rel=canonical href=https://canonical.url/to/page><link crossorigin=anonymous href=/assets/css/stylesheet.3f7ba6a00d316a1658af1e52b60f5592bfd3f63e1683217d447958625c9fec2a.css integrity="sha256-P3umoA0xahZYrx5Stg9Vkr/T9j4WgyF9RHlYYlyf7Co=" rel="preload stylesheet" as=style><link rel=icon href=http://localhost:1313/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://localhost:1313/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://localhost:1313/favicon-32x32.png><link rel=apple-touch-icon href=http://localhost:1313/apple-touch-icon.png><link rel=mask-icon href=http://localhost:1313/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=http://localhost:1313/posts/tail-of-two-regulation-and-compliance/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="http://localhost:1313/posts/tail-of-two-regulation-and-compliance/"><meta property="og:site_name" content="T|A"><meta property="og:title" content="NOTES: Tail of Two Regulation and Compliance"><meta property="og:description" content="Notes from building fintech features and surviving real audits."><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-08-25T07:52:54-07:00"><meta property="article:modified_time" content="2024-08-25T07:52:54-07:00"><meta property="article:tag" content="Notes"><meta property="article:tag" content="Fintech"><meta property="article:tag" content="Compliance"><meta property="article:tag" content="HIPAA"><meta property="article:tag" content="SOC2"><meta property="article:tag" content="Devops"><meta property="og:image" content="http://localhost:1313/images/papermod-cover.png"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="http://localhost:1313/images/papermod-cover.png"><meta name=twitter:title content="NOTES: Tail of Two Regulation and Compliance"><meta name=twitter:description content="Notes from building fintech features and surviving real audits."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"http://localhost:1313/posts/"},{"@type":"ListItem","position":2,"name":"NOTES: Tail of Two Regulation and Compliance","item":"http://localhost:1313/posts/tail-of-two-regulation-and-compliance/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"NOTES: Tail of Two Regulation and Compliance","name":"NOTES: Tail of Two Regulation and Compliance","description":"Notes from building fintech features and surviving real audits.","keywords":["notes","fintech","compliance","HIPAA","SOC2","devops","lessons"],"articleBody":" Tail of Two Regulation and Compliance Compliance told me to be boring. My app told me to be fast. Both were right.\nI learned the ugly lesson that regulation isn’t a checkbox you slap on before launch - it’s the scaffolding you build around a product so it doesn’t collapse under scale, lawyers, or reality. Below is one continuous train of thought from a college engineer who shipped features, survived a sweaty audit-ish week, and came out with practical habits you can adopt on day one.\nWhat HIPAA and SOC 2 are (short, practical) HIPAA - a U.S. law protecting health data (PHI). If your app handles health-related info tied to people, HIPAA matters. It mandates administrative, physical, and technical safeguards. Think training, access controls, and secure storage. SOC 2 - an audit framework from AICPA. Not a law, but a vendor trust report. It proves you have controls for Security, Availability, Processing Integrity, Confidentiality, and Privacy. Enterprises love it because it reduces their vendor risk. One is legal obligation (HIPAA); the other is a commercial trust badge (SOC 2). Both cost more energy to ignore than to implement.\nThe first day: concrete, non-sucky defaults Treat the first deploy like you’re already talking to an enterprise CISO. It changes how you design.\nDay-one checklist (do this before your second commit):\nMap your data flows. What we collect, why, where it moves, and where it rests. Draw it. Pretend the auditor is watching. RBAC by default. No admin:true toggles for interns. Roles, not exceptions. Secrets manager. Vault, AWS Secrets Manager, or equivalent. No secrets in config.yml. No exceptions. TLS everywhere. TLS in transit, encryption at rest where available. Use managed services for keys if you can. Structured logging + redaction. Don’t log raw PHI, PANs, SSNs, or tokens. Enforce schema with a linter. Retention policy. Put TTLs on logs and backups. If you don’t need 2 years of debug traces, don’t keep them. Incident one-pager. A one-page runbook: who calls legal, who flips the kill switch, and how to notify customers. Example redaction snippet:\n// simple log sanitizer (pseudo) function sanitize(obj) { return { ...obj, ssn: mask(obj.ssn), // show only last 4 card: hashLast4(obj.card), token: '[REDACTED]' } } Small things like this save you weeks later.\nWhy retrofitting hurts (my sad tale) We shipped a helpful logging hook that printed error payloads to make debugging instant. It felt like magic. It was also writing PHI and tokens in plaintext to our logs.\nWhen a security review found it:\nWe spent three weeks rewriting hundreds of logging call sites. We had to reprocess logs and scrub PII from backups - painful, slow, and error-prone. Two deals paused while legal did “due diligence.” Hiring momentum slowed because founders were on calls with lawyers. Engineers lost a little faith in “move fast” as a motto; we learned that speed without guardrails breaks trust. The technical cost was measurable. The human cost - reputation, stress, morale - was worse.\nObfuscation \u0026 dataset hygiene - not glamour, but necessary If you need realistic data without real people, use tokenization, salted hashing, aggregation, or differential privacy depending on the use case.\nTokenization/pseudonymization - replace IDs with tokens so you can link records without revealing identity. Salted hashes - deterministic but safer; rotate salts carefully. Aggregation/binning - share ranges, not exact values. Differential privacy - math noise; powerful but easy to misuse. Rule of thumb: obfuscation is only effective if your keys/salts are managed properly. Treat tokens as secrets.\nIncident response: practice like a drill team Real incidents are messy. Practice makes the real thing survivable.\nKeep runbooks one page. Name people, steps, and communication templates. Run tabletop exercises quarterly. Simulate: “DB contains unredacted PHI.” Talk it out. Automate evidence collection (access logs, deploy IDs) so audits don’t require heroic digging. Postmortems: no blame, just facts → hypothesis → fix → follow-up. Communication is a control. Tell customers early, clearly, and with a plan.\nContracts, vendors, and the boring-but-essential parts Engineers often tune out contract language until it’s urgent. Don’t.\nBAAs are mandatory for HIPAA-covered PHI. If a vendor won’t sign a BAA, don’t pass PHI through them. For SOC 2-bound customers, have your vendor risk assessments and evidence ready. Treat contractual promises as product requirements - if a customer asks for a SOC 2 report, that’s now part of the product roadmap. Contracts set expectations. Meet them.\nA practical 30/90/180 cadence to actually ship trust Day 1-30: map data, RBAC, secrets manager, TLS, structured logs, one-page incident runbook. Day 31-90: automated redaction pipeline, retention policies, basic access review cadence, vendor BAAs. Run your first tabletop. Day 91-180: continuous vulnerability scanning, backups verification, automated evidence collection for audits. Start preparing for SOC 2 Type I if that’s your goal. SOC 2 Type I = snapshot of controls. Type II = controls operating over time. Plan months, not days.\nClosing: the attitude (not the checklist) The best practice I learned: treat constraints as design inputs. When you design to minimize data collection, you also reduce blast radius. When you bake RBAC into your models, you reduce accidental misuse. Automation turns compliance from a chore into a feature.\nCompliance is boring until it saves your product, your users, or your reputation. Build the boring stuff early. Ship the cool stuff fast, but protected. If your future self is grateful, you probably did it right.\n","wordCount":"894","inLanguage":"en","image":"http://localhost:1313/images/papermod-cover.png","datePublished":"2024-08-25T07:52:54-07:00","dateModified":"2024-08-25T07:52:54-07:00","author":{"@type":"Person","name":"Me"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:1313/posts/tail-of-two-regulation-and-compliance/"},"publisher":{"@type":"Organization","name":"T|A","logo":{"@type":"ImageObject","url":"http://localhost:1313/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=http://localhost:1313/ accesskey=h title="T|A (Alt + H)">T|A</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=http://localhost:1313/about title=About><span>About</span></a></li><li><a href=http://localhost:1313/chronicles title=Chronicles><span>Chronicles</span></a></li><li><a href=http://localhost:1313/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=http://localhost:1313/tags/ title=Tags><span>Tags</span></a></li><li><a href=https://github.com/t-avil title=Github><span>Github</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=http://localhost:1313/>Home</a>&nbsp;»&nbsp;<a href=http://localhost:1313/posts/>Posts</a></div><h1 class="post-title entry-hint-parent">NOTES: Tail of Two Regulation and Compliance</h1><div class=post-description>Notes from building fintech features and surviving real audits.</div><div class=post-meta><span title='2024-08-25 07:52:54 -0700 PDT'>August 25, 2024</span>&nbsp;·&nbsp;5 min&nbsp;·&nbsp;894 words&nbsp;·&nbsp;Me&nbsp;|&nbsp;<a href=https://github.com/t-avil/blog/tree/main/content/posts/tail-of-two-regulation-and-compliance.md rel="noopener noreferrer edit" target=_blank>Suggest Changes</a></div></header><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><nav id=TableOfContents><ul><li><a href=#what-hipaa-and-soc-2-are-short-practical>What HIPAA and SOC 2 <em>are</em> (short, practical)</a></li><li><a href=#the-first-day-concrete-non-sucky-defaults>The first day: concrete, non-sucky defaults</a></li><li><a href=#why-retrofitting-hurts-my-sad-tale>Why retrofitting hurts (my sad tale)</a></li><li><a href=#obfuscation--dataset-hygiene---not-glamour-but-necessary>Obfuscation & dataset hygiene - not glamour, but necessary</a></li><li><a href=#incident-response-practice-like-a-drill-team>Incident response: practice like a drill team</a></li><li><a href=#contracts-vendors-and-the-boring-but-essential-parts>Contracts, vendors, and the boring-but-essential parts</a></li><li><a href=#a-practical-3090180-cadence-to-actually-ship-trust>A practical 30/90/180 cadence to actually ship trust</a></li><li><a href=#closing-the-attitude-not-the-checklist>Closing: the attitude (not the checklist)</a></li></ul></nav></div></details></div><div class=post-content><hr><h1 id=tail-of-two-regulation-and-compliance>Tail of Two Regulation and Compliance<a hidden class=anchor aria-hidden=true href=#tail-of-two-regulation-and-compliance>#</a></h1><blockquote><p><em>Compliance told me to be boring. My app told me to be fast. Both were right.</em></p></blockquote><p>I learned the ugly lesson that regulation isn&rsquo;t a checkbox you slap on before launch - it’s the scaffolding you build around a product so it doesn&rsquo;t collapse under scale, lawyers, or reality. Below is one continuous train of thought from a college engineer who shipped features, survived a sweaty audit-ish week, and came out with practical habits you can adopt on day one.</p><hr><h2 id=what-hipaa-and-soc-2-are-short-practical>What HIPAA and SOC 2 <em>are</em> (short, practical)<a hidden class=anchor aria-hidden=true href=#what-hipaa-and-soc-2-are-short-practical>#</a></h2><ul><li><strong>HIPAA</strong> - a U.S. law protecting health data (PHI). If your app handles health-related info tied to people, HIPAA matters. It mandates administrative, physical, and technical safeguards. Think training, access controls, and secure storage.</li><li><strong>SOC 2</strong> - an audit framework from AICPA. Not a law, but a vendor trust report. It proves you have controls for <strong>Security</strong>, <strong>Availability</strong>, <strong>Processing Integrity</strong>, <strong>Confidentiality</strong>, and <strong>Privacy</strong>. Enterprises love it because it reduces their vendor risk.</li></ul><p>One is legal obligation (HIPAA); the other is a commercial trust badge (SOC 2). Both cost more energy to ignore than to implement.</p><hr><h2 id=the-first-day-concrete-non-sucky-defaults>The first day: concrete, non-sucky defaults<a hidden class=anchor aria-hidden=true href=#the-first-day-concrete-non-sucky-defaults>#</a></h2><p>Treat the first deploy like you’re already talking to an enterprise CISO. It changes how you design.</p><p><strong>Day-one checklist (do this before your second commit):</strong></p><ol><li><strong>Map your data flows.</strong> What we collect, why, where it moves, and where it rests. Draw it. Pretend the auditor is watching.</li><li><strong>RBAC by default.</strong> No <code>admin:true</code> toggles for interns. Roles, not exceptions.</li><li><strong>Secrets manager.</strong> Vault, AWS Secrets Manager, or equivalent. No secrets in <code>config.yml</code>. No exceptions.</li><li><strong>TLS everywhere.</strong> TLS in transit, encryption at rest where available. Use managed services for keys if you can.</li><li><strong>Structured logging + redaction.</strong> Don’t log raw PHI, PANs, SSNs, or tokens. Enforce schema with a linter.</li><li><strong>Retention policy.</strong> Put TTLs on logs and backups. If you don’t need 2 years of debug traces, don’t keep them.</li><li><strong>Incident one-pager.</strong> A one-page runbook: who calls legal, who flips the kill switch, and how to notify customers.</li></ol><p>Example redaction snippet:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-js data-lang=js><span class=line><span class=cl><span class=c1>// simple log sanitizer (pseudo)
</span></span></span><span class=line><span class=cl><span class=c1></span><span class=kd>function</span> <span class=nx>sanitize</span><span class=p>(</span><span class=nx>obj</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>return</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=p>...</span><span class=nx>obj</span><span class=p>,</span>
</span></span><span class=line><span class=cl>    <span class=nx>ssn</span><span class=o>:</span> <span class=nx>mask</span><span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>ssn</span><span class=p>),</span>     <span class=c1>// show only last 4
</span></span></span><span class=line><span class=cl><span class=c1></span>    <span class=nx>card</span><span class=o>:</span> <span class=nx>hashLast4</span><span class=p>(</span><span class=nx>obj</span><span class=p>.</span><span class=nx>card</span><span class=p>),</span>
</span></span><span class=line><span class=cl>    <span class=nx>token</span><span class=o>:</span> <span class=s1>&#39;[REDACTED]&#39;</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>Small things like this save you weeks later.</p><hr><h2 id=why-retrofitting-hurts-my-sad-tale>Why retrofitting hurts (my sad tale)<a hidden class=anchor aria-hidden=true href=#why-retrofitting-hurts-my-sad-tale>#</a></h2><p>We shipped a helpful logging hook that printed error payloads to make debugging instant. It felt like magic. It was also writing PHI and tokens in plaintext to our logs.</p><p>When a security review found it:</p><ul><li>We spent <strong>three weeks</strong> rewriting hundreds of logging call sites.</li><li>We had to reprocess logs and scrub PII from backups - painful, slow, and error-prone.</li><li>Two deals paused while legal did &ldquo;due diligence.&rdquo; Hiring momentum slowed because founders were on calls with lawyers.</li><li>Engineers lost a little faith in “move fast” as a motto; we learned that speed without guardrails breaks trust.</li></ul><p>The technical cost was measurable. The human cost - reputation, stress, morale - was worse.</p><hr><h2 id=obfuscation--dataset-hygiene---not-glamour-but-necessary>Obfuscation & dataset hygiene - not glamour, but necessary<a hidden class=anchor aria-hidden=true href=#obfuscation--dataset-hygiene---not-glamour-but-necessary>#</a></h2><p>If you need realistic data without real people, use <strong>tokenization</strong>, <strong>salted hashing</strong>, <strong>aggregation</strong>, or <strong>differential privacy</strong> depending on the use case.</p><ul><li><strong>Tokenization/pseudonymization</strong> - replace IDs with tokens so you can link records without revealing identity.</li><li><strong>Salted hashes</strong> - deterministic but safer; rotate salts carefully.</li><li><strong>Aggregation/binning</strong> - share ranges, not exact values.</li><li><strong>Differential privacy</strong> - math noise; powerful but easy to misuse.</li></ul><p>Rule of thumb: obfuscation is only effective if your keys/salts are managed properly. Treat tokens as secrets.</p><hr><h2 id=incident-response-practice-like-a-drill-team>Incident response: practice like a drill team<a hidden class=anchor aria-hidden=true href=#incident-response-practice-like-a-drill-team>#</a></h2><p>Real incidents are messy. Practice makes the real thing survivable.</p><ul><li>Keep runbooks one page. Name people, steps, and communication templates.</li><li>Run tabletop exercises quarterly. Simulate: “DB contains unredacted PHI.” Talk it out.</li><li>Automate evidence collection (access logs, deploy IDs) so audits don’t require heroic digging.</li><li>Postmortems: <em>no blame</em>, just facts → hypothesis → fix → follow-up.</li></ul><p>Communication is a control. Tell customers early, clearly, and with a plan.</p><hr><h2 id=contracts-vendors-and-the-boring-but-essential-parts>Contracts, vendors, and the boring-but-essential parts<a hidden class=anchor aria-hidden=true href=#contracts-vendors-and-the-boring-but-essential-parts>#</a></h2><p>Engineers often tune out contract language until it&rsquo;s urgent. Don’t.</p><ul><li><strong>BAAs</strong> are mandatory for HIPAA-covered PHI. If a vendor won&rsquo;t sign a BAA, don&rsquo;t pass PHI through them.</li><li>For SOC 2-bound customers, have your vendor risk assessments and evidence ready.</li><li>Treat contractual promises as product requirements - if a customer asks for a SOC 2 report, that’s now part of the product roadmap.</li></ul><p>Contracts set expectations. Meet them.</p><hr><h2 id=a-practical-3090180-cadence-to-actually-ship-trust>A practical 30/90/180 cadence to actually ship trust<a hidden class=anchor aria-hidden=true href=#a-practical-3090180-cadence-to-actually-ship-trust>#</a></h2><ul><li><strong>Day 1-30:</strong> map data, RBAC, secrets manager, TLS, structured logs, one-page incident runbook.</li><li><strong>Day 31-90:</strong> automated redaction pipeline, retention policies, basic access review cadence, vendor BAAs. Run your first tabletop.</li><li><strong>Day 91-180:</strong> continuous vulnerability scanning, backups verification, automated evidence collection for audits. Start preparing for SOC 2 Type I if that’s your goal.</li></ul><p>SOC 2 Type I = snapshot of controls. Type II = controls operating over time. Plan months, not days.</p><hr><h2 id=closing-the-attitude-not-the-checklist>Closing: the attitude (not the checklist)<a hidden class=anchor aria-hidden=true href=#closing-the-attitude-not-the-checklist>#</a></h2><p>The best practice I learned: <strong>treat constraints as design inputs</strong>. When you design to minimize data collection, you also reduce blast radius. When you bake RBAC into your models, you reduce accidental misuse. Automation turns compliance from a chore into a feature.</p><p>Compliance is boring until it saves your product, your users, or your reputation. Build the boring stuff early. Ship the cool stuff fast, but protected. If your future self is grateful, you probably did it right.</p></div><footer class=post-footer><ul class=post-tags><li><a href=http://localhost:1313/tags/notes/>Notes</a></li><li><a href=http://localhost:1313/tags/fintech/>Fintech</a></li><li><a href=http://localhost:1313/tags/compliance/>Compliance</a></li><li><a href=http://localhost:1313/tags/hipaa/>HIPAA</a></li><li><a href=http://localhost:1313/tags/soc2/>SOC2</a></li><li><a href=http://localhost:1313/tags/devops/>Devops</a></li><li><a href=http://localhost:1313/tags/lessons/>Lessons</a></li></ul><nav class=paginav><a class=prev href=http://localhost:1313/posts/end2ending-data-warehouse/><span class=title>« Prev</span><br><span>NOTES: End to ending Data Warehouses as a concept</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=http://localhost:1313/>T|A</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>